clear;
close all;
clc;

vesicle_data = [304.104699000000,313.006668000000,323.614062000000,315.805345000000,320.577404000000,312.347970000000,305.953916000000,312.593109000000,310.202169000000,317.906990000000,306.255977000000,316.657884000000,300.681881000000,324.405929000000,302.594398000000,316.756714000000,311.353748000000,323.740917000000,304.470090000000,307.327004000000,300.694817000000,322.345944000000,321.352506000000,307.676446000000,321.984306000000,300.033351000000,305.177019000000,323.969947000000,317.655428000000,319.091426000000,307.211880000000,311.422758000000,320.029458000000,307.230492000000,316.964242000000,305.143267000000,305.657437000000,320.870689000000,309.354213000000,312.934081000000,310.312614000000,323.723596000000,324.430676000000,322.618477000000,321.166018000000,304.792061000000,311.902907000000,304.272418000000,311.201684000000,300.220891000000,315.790044000000,302.987231000000,307.165630000000,314.951590000000,315.752129000000,302.365508000000,314.339548000000,313.279509000000,300.848146000000,314.659953000000,301.690241000000,306.212690000000,323.730620000000,324.941914000000,313.371941000000,308.849968000000,324.886079000000,324.026621000000,319.254812000000,303.761619000000,306.044682000000,300.015845000000,318.417762000000,316.789550000000,319.492265000000,307.687789000000,318.528583000000,307.951346000000,324.813508000000,322.530181000000,302.154404000000,324.160551000000,300.255935000000,306.447527000000,301.580279000000,321.754403000000,320.172017000000,312.396165000000,308.372519000000,315.362792000000,322.170988000000,318.462654000000,314.591265000000,320.157712000000,304.972256000000,316.339406000000,315.258205000000,321.024123000000,312.759093000000,322.744492000000,314.802434000000,303.157393000000,310.999167000000,306.594613000000,308.142650000000,324.242654000000,315.514489000000,314.417914000000,309.701451000000,314.360848000000,313.786274000000,312.169143000000,316.551194000000,305.023273000000,300.639515000000,318.032711000000,323.947865000000,319.454461000000,319.131765000000,324.504353000000,313.074992000000,308.985491000000,314.008780000000,324.441926000000,304.506619000000,312.360492000000,308.188657000000,309.792539000000,315.975932000000,312.036994000000,310.463302000000,312.151406000000,304.847512000000,316.727826000000,309.986143000000,306.744785000000,315.469800000000,317.827586000000,315.086939000000,321.442987000000,312.292268000000,311.274172000000,308.753954000000,321.855661000000,307.134725000000,302.807273000000,324.308314000000,310.904463000000,303.180896000000,314.222314000000,307.601355000000,311.305959000000,323.445006000000,317.881184000000,302.856128000000,300.341961000000,303.196457000000,313.528148000000,307.526511000000,307.841621000000,312.100623000000,311.489250000000,320.663271000000,321.029992000000,303.614654000000,313.054225000000,324.563488000000,313.180640000000,315.779504000000,304.498337000000,320.857522000000,319.771296000000,303.246908000000,322.303407000000,306.687247000000,321.622835000000,307.980423000000,323.081200000000,303.958505000000,323.917663000000,301.000889000000,302.966110000000,324.272285000000,320.385295000000,320.672020000000,303.605799000000,304.689571000000,310.919193000000,301.109762000000,320.576234000000,307.436087000000,310.881586000000,304.442092000000,315.408794000000,305.108634000000,319.978593000000,311.717348000000,309.805639000000,307.333215000000,301.575269000000,308.558300000000,305.655530000000,315.416217000000,301.497442000000,315.241954000000,309.854110000000,312.246838000000,318.976050000000,303.970260000000,309.850729000000,324.515266000000,320.558321000000,304.873186000000,300.045205000000,319.719496000000,300.260394000000,323.444905000000,315.600510000000,320.587496000000,321.890225000000,320.989015000000,310.827357000000,315.117422000000,311.599078000000,317.615699000000,317.060264000000,309.404536000000,322.171473000000,316.108275000000,301.720609000000,320.122218000000,304.118339000000,309.664759000000,320.659707000000,323.005410000000,301.946588000000,307.120890000000,302.599335000000,319.894399000000,307.755954000000,321.970231000000,320.140600000000,323.436508000000,305.083485000000,309.731463000000,313.985434000000,309.168165000000,310.427653000000,303.515069000000,308.449760000000,323.443428000000,315.519811000000,300.567973000000,303.835224000000,310.015400000000,315.194835000000,306.635435000000,314.488774000000,303.871980000000,304.328463000000,311.931792000000,308.617276000000,313.501260000000,304.073677000000,316.875031000000,311.839715000000,320.262736000000,313.096620000000,314.186257000000,321.520602000000,314.621303000000,315.116658000000,321.749657000000,304.430755000000,301.741900000000,302.901619000000,319.414218000000,316.452395000000,303.699353000000,312.598618000000,313.846603000000,319.526220000000,307.696946000000,307.398039000000,324.342038000000,312.704026000000,313.894673000000,315.611431000000,301.915157000000,302.017271000000,323.470325000000,321.755847000000,306.511572000000,323.047944000000,319.555719000000,317.165057000000,321.869593000000,301.810950000000,305.010530000000,303.213154000000];
sample_row = (vesicle_data);
bootstrap = zeros(1, 300); %preallocate space
bootstrap_mean = zeros(1, 600); %preallocate space

for j = 1:600;
    for i = 1:300;
        idx = randi(300);
        bootstrap(i) = sample_row(idx); %assign each random value of sample_row to bootstrap
    end
    bootstrap_mean(j) = mean(bootstrap);
end

bootstrap_stdev = std(bootstrap_mean);
bootstrap_grand_mean = mean(bootstrap_mean);

hold on;
subplot(1,2,1);
histogram(bootstrap_mean, 20);
xlabel('Diameter Measurement (nm)');
ylabel('Frequency');

subplot(1,2,2)
plot(bootstrap_mean, 'r.')
hold on
plot([0, 600],[bootstrap_grand_mean, bootstrap_grand_mean], 'b-')
hold off
ylabel('Bootstrap Mean Values (nm)')
xlabel('Arbitrary Units')
legend('bootstrap mean', 'bootstrap grand mean');